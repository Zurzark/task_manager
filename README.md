# 智能任务管理器 (Smart Task Manager) - AI Powered v3.5

## 📖 项目概述
**Smart Task Manager** 是一个基于原生 JavaScript (ES Modules) 构建的现代化、无服务器 (Serverless) 任务管理应用。它深度集成了 AI 智能解析能力，结合 GTD (Getting Things Done) 与四象限工作法，旨在提供轻量、高效且隐私安全的个人任务管理解决方案。

本项目坚持 **"No Build"** 理念，无需 Node.js 构建流程，开箱即用，代码结构清晰，适合学习原生 JS 架构或作为个人生产力工具使用。

---

## ✨ 核心功能详解

### 1. 🤖 AI 智能增强 (AI-Powered)
本项目核心亮点，通过 LLM (大语言模型) 赋能任务管理全流程：

- **自然语言交互**: 在输入框直接输入 "明天上午10点开会 @#12"，AI 自动识别时间、关联任务、优先级。
- **RAG 上下文增强**: 内置轻量级 RAG 机制，根据任务描述自动检索相关的 "记忆片段" (Memory)，辅助 AI 理解项目背景。
- **✨ 智能整理 (Smart Organizer)**:
  - **递归层级识别**: 自动分析选中任务的语义，构建多级父子任务树（如 项目 -> 阶段 -> 子任务）。
  - **智能去重**: 识别语义重复的任务，提供合并建议（保留最早创建或信息最全的任务）。
  - **关系网络构建**: 精准区分 **依赖关系** (必须先做A再做B) 和 **关联关系** (A与B相关)。
  - **自定义 Prompt**: 支持在设置中自定义智能整理的系统提示词，适配不同的整理风格。

### 2. 🖱️ 交互与视图 (Views & Interaction)
提供多种视图以适应不同的管理场景，并支持流畅的**拖拽交互**。

#### **列表视图 (List View)** - *结构化管理*
- **树形结构**: 清晰展示多级父子任务关系。
- **拖拽排序与嵌套**:
  - **排序**: 拖拽任务到其他任务的**上半部**或**下半部**，即可插入为上方或下方兄弟节点。
  - **嵌套**: 拖拽任务到其他任务的**中间区域**，即可将其变为子任务。
  - **移出**: 将子任务拖拽到**表头区域**或列表**空白处**，即可将其移出变为根任务。
- **批量操作**: 支持全选/多选，进行批量完成、删除或 AI 整理。

#### **看板视图 (Kanban View)** - *流转管理*
- **分组管理**: 默认按优先级分为四列 (重要紧急、重要不紧急、不重要紧急、不重要不紧急)。
- **拖拽流转**:
  - **调整优先级**: 将卡片拖拽到不同列，自动更新任务优先级。
  - **列内排序**: 在同一列内上下拖拽卡片调整顺序。

#### **四象限视图 (Quadrant View)** - *艾森豪威尔矩阵*
- **聚焦核心**: 直观展示 Q1-Q4 任务分布，帮助你聚焦 "重要且紧急" 的事务。
- **交互**: 同样支持跨象限拖拽修改优先级和象限内排序。

#### **日历视图 (Calendar View)** - *时间管理*
- **月/周切换**: 直观展示任务的截止日期分布。
- **状态标记**: 使用不同颜色和图标标记任务优先级与状态（逾期、今日、未来）。

### 3. ⏰ 智能提醒系统
全新的实时提醒机制，确保你不会错过任何重要任务。
- **实时弹窗**: 基于本地轮询机制，到达设定时间自动弹出醒目的提醒卡片。
- **智能延时 (Snooze)**:
  - 提供多种延时选项：5分钟、15分钟、30分钟、1小时、3小时。
  - **"明天 09:00"**: 智能识别东八区 (Asia/Shanghai) 时间，一键推迟到次日早晨。
- **批量操作**: 支持"全部稍后提醒"和"全部忽略"，高效处理多个并发提醒。

### 4. 🔍 智能搜索与筛选
提供了强大的全局搜索能力，支持复杂的布尔逻辑，帮助你快速定位任务。
- **实时关键词搜索**: 输入即搜，支持标题、描述、标签及分类的全文检索。
- **高级逻辑语法**:
  - **与 (AND)**: 使用空格、`&` 或 `AND`。
  - **或 (OR)**: 使用 `|` 或 `OR`。
  - **非 (NOT)**: 使用 `!`、`-` (前缀) 或 `NOT`。
  - **分组**: 支持 `()` 括号嵌套。例如 `(后端 | 数据库) !Bug`。
- **组合筛选**:
  - **青蛙任务**: 一键筛选每日最重要的 "三只青蛙"。
  - **多维过滤**: 支持按 GTD 状态、任务状态、行动类型、时间范围等多维度组合筛选。

### 5. 🎯 高级任务属性体系
- **GTD 行动**: `Next` (下一步), `Waiting` (等待), `Someday` (将来)。
- **优先级**: Urgent / High / Medium / Low。
- **依赖管理**: 支持任务间的依赖 (`depends_on`) 与关联 (`related_to`)，防止循环依赖。
- **标签 (Tags)**: 灵活的标签系统，支持多维度分类。

### 6. 🛡️ 数据隐私与安全
- **本地优先 (Local First)**: 所有任务数据、配置、记忆均存储于浏览器 `LocalStorage`。
- **零服务端**: 除了调用 LLM API (OpenAI/DeepSeek 等) 外，数据不上传任何第三方服务器。
- **备份恢复**: 支持一键导出全量数据 (JSON)，随时备份或迁移环境。

---

## 📂 项目文件结构

```text
d:\小工具\web_project\task_manager\
├── index.html                  # [入口] 应用主页面，包含整体 DOM 结构与 UI 骨架
├── css/
│   ├── style.css               # 全局自定义样式与 Tailwind 补丁 (含拖拽视觉反馈样式)
│   └── remixicon.css           # 图标库资源
├── js/
│   ├── main.js                 # [启动] 应用入口，负责初始化、全局事件监听
│   ├── actions.js              # [交互] 核心交互逻辑，包括拖拽 (Drag & Drop) 处理、全局事件暴露
│   ├── store.js                # [数据] 核心状态管理 (Store)，负责 CRUD、筛选、排序与持久化
│   ├── memory.js               # [记忆] AI 记忆库管理 (MemoryStore)
│   ├── views.js                # [渲染] 纯函数组件，生成各视图 (List/Kanban/Quadrant) 的 HTML
│   ├── api.js                  # [服务] LLM API 调用封装 (Fetch Wrapper)
│   ├── utils.js                # [工具] 通用辅助函数 (时间、ID、JSON处理)
│   ├── tailwindcss.js          # [库] 本地集成的 Tailwind CSS 引擎
│   │
│   ├── ui/                     # [界面] UI 交互逻辑拆分
│   │   ├── core.js             # UI 核心调度 (updateUI, 侧边栏统计, 批量操作栏)
│   │   ├── modal-task.js       # 任务编辑/详情弹窗逻辑
│   │   ├── modal-settings.js   # 设置、API配置、Prompt配置、日志弹窗
│   │   ├── modal-memory.js     # 记忆库管理弹窗
│   │   ├── modal-ai.js         # AI 确认弹窗
│   │   └── tag-input.js        # 标签输入组件逻辑
│   │
│   └── features/               # [业务] 独立业务模块
│       ├── ai.js               # AI 解析流程控制 (Prompt构建 -> 调用 -> 回调)
│       ├── ai-organizer.js     # [AI] 智能整理核心逻辑 (层级/去重/关联分析)
│       ├── backup.js           # 数据备份与恢复逻辑
│       └── reminder.js         # 提醒系统核心逻辑 (轮询、弹窗、Snooze)
└── README.md                   # 本文档
```

---

## 🛠️ 技术架构

### 1. 模块化设计 (ES Modules)
项目完全采用 ES6 Modules 规范，通过 `<script type="module">` 引入，无需 Webpack/Vite 打包。
- `js/store.js`: 核心状态管理，集成了数据筛选 (`getFilteredTasks`) 和搜索逻辑。
- `js/features/`: 独立业务模块化，便于扩展新功能。

### 2. 状态管理 (Store Pattern)
- 单一数据源 (`store.tasks`), 变更通过 Actions (`store.addTask`, `store.updateTask`) 触发。
- 状态变更后自动持久化到 LocalStorage 并触发 UI 更新。
- **排序逻辑**: 引入 `order` 字段，结合手动拖拽与自动排序（如按时间），优先遵循用户的手动排序意图。

### 3. 样式方案
- 引入 `tailwindcss.js` (CDN/Local Build)，在浏览器端直接解析 Tailwind 类名，实现快速 UI 开发。
- 配合 `remixicon` 提供精美图标。

---

## 🚀 快速开始

### 1. 环境准备
- 只需要一个现代浏览器 (Chrome, Edge, Firefox 等)。
- **推荐**: 使用 VS Code 的 **Live Server** 插件运行。

### 2. 运行项目
1. 克隆或下载本项目。
2. 在项目根目录启动 HTTP 服务。
3. 浏览器访问 `http://localhost:8000/index.html`。

### 3. 配置 AI
1. 点击左侧边栏底部的 **"设置"**。
2. 输入你的 LLM API 地址 (Base URL) 和 API Key。
3. 选择模型 (如 `gpt-4o`, `deepseek-chat` 等)。
4. (可选) 在 "Prompt 设置" 中微调智能整理的提示词。
5. 保存配置。

---

## ⚠️ 注意事项
- **数据安全**: 清除浏览器缓存会丢失所有数据，请务必定期使用 "备份" 功能。
- **兼容性**: 依赖 ES6+ 特性，不支持 IE 浏览器。
- **Token 消耗**: 记忆库越多，发送给 AI 的 Context 越长，请关注 Token 使用情况。

---
*Generated by Trae AI Assistant*
